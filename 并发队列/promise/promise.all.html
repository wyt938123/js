<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <div>
        面试官可能追问


如何处理输入数组为空的情况？
回答：如果输入数组为空，直接调用 resolve 返回空数组。
javascript 体验AI代码助手 代码解读复制代码if (promises.length === 0) {
  resolve([]);
}



如何处理输入数组中包含非 Promise 值？
回答：通过 Promise.resolve 将非 Promise 值转换为已解决的 Promise。




作者：eason_fan
链接：https://juejin.cn/post/7490445072074555443
来源：稀土掘金
著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。
    </div>
    <script>
        Promise.myAll = function(promises){
            return new Promise((resolve, reject) => {
                let results = new Array(promises.length);
                let completedCount = 0;
                promises.forEach((promise,i) => {
                    promise.then(res=>{
                        results[i] = res;
                        completedCount++;
                        if(completedCount === promises.length){
                            resolve(results);
                        }
                    },rej=>{
                        reject(rej);
                    })
                });

            });
        }

        //测试
        const p1 = new Promise((resolve) => {
            setTimeout(() => {
                resolve('结果1');
            }, 1000);
        });
        const p2 = new Promise((resolve) => {
            setTimeout(() => {
                resolve('结果2');
            }, 2000);
        });
        // const p3 = new Promise((resolve, reject) => {
        //     setTimeout(() => {
        //         reject('错误3');
        //     }, 1500);
        // });
        const result = Promise.myAll([p1, p2 /*, p3 */]).then(res => {
            
            console.log('所有Promise成功，结果：', res);
            return res;
        }).catch(err => {
            console.log('有Promise失败，错误：', err);
        });
        console.log('result:',result);
    </script>
</body>
</html>